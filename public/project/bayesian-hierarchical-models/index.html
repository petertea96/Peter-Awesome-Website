<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.6.2">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Peter Tea">

  
  
  
    
  
  <meta name="description" content="Looking into Point-based models">

  
  <link rel="alternate" hreflang="en-us" href="/project/bayesian-hierarchical-models/">

  


  
  
  
  <meta name="theme-color" content="#25af84">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/project/bayesian-hierarchical-models/">

  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Peter Tea">
  <meta property="og:url" content="/project/bayesian-hierarchical-models/">
  <meta property="og:title" content="Bayesian Hierarchical Models in Tennis | Peter Tea">
  <meta property="og:description" content="Looking into Point-based models"><meta property="og:image" content="/project/bayesian-hierarchical-models/featured.jpg">
  <meta property="twitter:image" content="/project/bayesian-hierarchical-models/featured.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-04-19T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2020-04-19T00:00:00&#43;00:00">
  

  


    











<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/project/bayesian-hierarchical-models/"
  },
  "headline": "Bayesian Hierarchical Models in Tennis",
  
  "image": [
    "/project/bayesian-hierarchical-models/featured.jpg"
  ],
  
  "datePublished": "2020-04-19T00:00:00Z",
  "dateModified": "2020-04-19T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Peter Tea"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Peter Tea",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/icon-512.png"
    }
  },
  "description": "Looking into Point-based models"
}
</script>

  

  


  


  





  <title>Bayesian Hierarchical Models in Tennis | Peter Tea</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    
    
      <a class="navbar-brand" href="/">Peter Tea</a>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/PTEA_Resume.pdf"><span>Resume</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/talk"><span>Presentations</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article article-project">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>Bayesian Hierarchical Models in Tennis</h1>

  

  


<div class="article-metadata">

  
  
  
  
  <div>
    



  
  <span><a href="/authors/admin/">Peter Tea</a></span>

  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Apr 19, 2020
  </span>
  

  

  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/tennis/">Tennis</a></span>
  

</div>

  













<div class="btn-links mb-3">
  
  








  
    
  



<a class="btn btn-outline-primary my-1 mr-1" href="/Report.pdf" target="_blank" rel="noopener">
  PDF
</a>

















</div>


</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 480px;">
  <div style="position: relative">
    <img src="/project/bayesian-hierarchical-models/featured_hu97f7a10b099f8c9b36349a4655c3e38e_1151325_720x0_resize_q90_lanczos.jpg" alt="" class="featured-image">
    <span class="article-header-caption">Photo by Renith R on Unsplash</span>
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      


<div id="point-based-models" class="section level2">
<h2>Point-Based Models</h2>
<p>Point-Based models are very cool models applied in tennis that can provide us with exciting and competitive insights into the game. With them, we can answer intriguing questions like: Which player is favoured to win in a match-up? How unlikely is an observed upset?</p>
<p>In constructing point-based models, assumptions are first made on service point outcomes: the main one being that service points are independent and identically distributed (I.I.D.) for an entire match. This amounts to saying that all service points in a match are played equally. If we (skeptically) believe that this I.I.D. assumption is true, then it is possible to make some interesting predictions on any legit tennis match. <span class="citation">Newton and Keller (2005)</span>} showed with combinatorics and geometric series representations, that by simply knowing both players’ serve win probabilities we can then calculate the probabilities of either player winning the tennis match and of observing specific set scores. The diffulty now, then, is obtaining reliable estimates of player serve win probabilities prior to a match.</p>
<p>Since serve outcome data are collected repeatedly for tennis players following each match played, we know that serve data are not truly independent. Ideally, we should account for player variation since the serves observed from one player will be temporally pseudoreplicated! This whole setup seems to be ripe for a hierarchical model application, where each player is considered as a separate hierarchical level.</p>
<p><span class="citation">Ingram (2019)</span> proposes a Bayesian Hierarchical Model to provide posterior serve win probabilities for players in a head-to-head (singles) matchup. This Bayesian model accounts for player serve and return skills fluctuating across different periods using a Gaussian random walk, as well as player-specific court preferences and the tournament at which the match is being played.</p>
<p>For this post, I present some interesting visualizations produced from fitting this Bayesian point-based model. Tennis data curated from 2018 to 2020 (until the end of the Australian Open) from one of Jeff Sackmann’s repositories, was used to feed the model. While all necessary code to fit the model is already available on the author’s <a href="https://github.com/martiningram/tennis_bayes_point_based">GitHub page</a>, I’ve instead fit the model in R (whereas the author uses Python). Bayesian posterior samples were drawn using <code>rstan</code>, a package that uses a Hamiltonian Monte Carlo algorithm.</p>
</div>
<div id="who-are-the-top-skilled-atp-players" class="section level2">
<h2>Who are the top skilled ATP Players?</h2>
<p>From the posterior distribution of player serve and return skills, I’ve ranked the top 10 players for each skill based on the players’ posterior median. Below are plots representing the top 10 ATP players for serve and return skills (dots represent posterior medians, while bands represent a 90% credible interval).</p>
<p><img src="atp_skill_18_20.png" /></p>
<p>In general, players will have higher serve skills than return skills since it is easier for players to win points on their serve compared to their return against the opponent’s serve. One surreal feature shown here is that Novak Djokovic’s posterior median return skill is larger than some of the top 10 players’ serve skill!</p>
<p>We see that the top players with the highest serve skills sensibly adhere to who tennis fans would believe are the best servers in the game. The top ranked serve skill player, Canadian Milos Raonic, arguably has one of the most bombarding serves in history, while other notable tennis stars like Djokovic, Nadal and Federer are also ranked highly by the model.</p>
</div>
<div id="who-are-the-top-surface-atp-players" class="section level2">
<h2>Who are the top surface ATP Players?</h2>
<p>Next up, we’ll look at which players get the biggest boost from the 3 tennis surfaces. The following plots should be interpreted as “additional surface skill”, which were previously unaccounted for in the players’ serve and return skill plots above.</p>
<p><img src="atp_surface_18_20.png" /></p>
<p>From the clay plot, Rafael Nadal (i.e. the “King of Clay”) easily cracks the top 10 players boosted from the clay surface list, as expected with his stellar career on the clay courts. From the grass plot, we round out the other 2 kings (Fed and Djokovic) who rank particularly high on this surface. Finally, for the hard-court plot, we find other top familiar names in the ATP. Surprisingly, David Ferrer (retired 2019) was ranked 8th on our list! Here, it wouldn’t make too much sense to say that a retired player would still be ranked top 10. Perhaps this anomaly may be attributed to some deft performances on hardcourt from Ferrer before his retirement.</p>
</div>
<div id="djokovic-vs.thiem-2020-australian-open" class="section level2">
<h2>Djokovic vs. Thiem 2020 Australian Open</h2>
<p>Next up, I used the model to predict the Australian Open 2020 Final match played between Djokovic and Thiem. For both these players, I first obtained their posterior serve win estimates.</p>
<p><img src="atp_DTAO_20.png" /></p>
<p>From the above Posterior serve win probabilities plot, we see that Djokovic (in red) has an advantage in winning his serve games against Thiem (in blue). When considering posterior medians, we would predict that Djokovic would win just under 70% of his service games, compared to Thiem winning just under 61% of his own respective service games.</p>
<p>Using the posterior serve wins for both these players in the head-to-head matchup, we can then produce the posterior distribution of either playing winning the match.</p>
<p><img src="atp_DTAO_match_20.png" /></p>
<p>From the plot above, we calculate the probability of Djokovic winning this match having <span class="math inline">\(90\%\)</span> credible interval of [<span class="math inline">\(70.4 \%\)</span>, <span class="math inline">\(98.4 \%\)</span>]: quite a considerable advantage for Djokovic!</p>
<p>With the posterior serve wins for both these players in the head-to-head matchup, we can also produce the probabilities of observing set scores in this matchup.</p>
<p><img src="atp_DTAO_setscore_20.png" /></p>
<p>The most likely set score, as predicted from the model, is 6-4 and 6-3 for Djokovic.</p>
<p>How do these predictions stack up with what already happened?
Reassuringly, Djokovic did end up beating Thiem in this match with a final score of (6-4, 4-6, 2-6, 6-3, 6-4). These observed scores complement the most likely scores we predicted, with the exception of the 2-6 set score which had a <span class="math inline">\(1.6 \%\)</span> chance of occurring!</p>
<div id="whos-got-the-best-chance-of-winning-the-remaining-slams" class="section level3">
<h3>Who’s got the best chance of winning the remaining Slams?</h3>
<p>Unfortunately, Wimbledon has been cancelled and there will be no crowned grass champion this year. However, with the point-based models we can instead predict who has the best chances of winning at this illustrious grand slam tournament. By calculating each players’ predicted serve win probability at Wimbledon, we get that <code>Novak Djokovic</code> has the highest serve win probability of any ATP player, and thus is predicted to be the most likely Wimbledon champion. Besides Djokovic, who has the best chance of winning Wimbledon? Using the model, I obtain match win probabilities for ATP players against Djokovic. Here are the top 10 players with the highest match win probabilities against Djokovic:</p>
<table>
<thead>
<tr class="header">
<th align="left">Player</th>
<th align="right">Win %</th>
<th align="left">90% Credible Interval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Rafael Nadal</td>
<td align="right">23.7</td>
<td align="left">[ 4 - 60 ]</td>
</tr>
<tr class="even">
<td align="left">Roger Federer</td>
<td align="right">20.9</td>
<td align="left">[ 4 - 56 ]</td>
</tr>
<tr class="odd">
<td align="left">Milos Raonic</td>
<td align="right">7.7</td>
<td align="left">[ 1 - 29 ]</td>
</tr>
<tr class="even">
<td align="left">Roberto Bautista Agut</td>
<td align="right">5.5</td>
<td align="left">[ 0 - 30 ]</td>
</tr>
<tr class="odd">
<td align="left">Stefanos Tsitsipas</td>
<td align="right">3.7</td>
<td align="left">[ 0 - 21 ]</td>
</tr>
<tr class="even">
<td align="left">Juan Martin del Potro</td>
<td align="right">2.6</td>
<td align="left">[ 0 - 23 ]</td>
</tr>
<tr class="odd">
<td align="left">Matteo Berrettini</td>
<td align="right">2.6</td>
<td align="left">[ 0 - 16 ]</td>
</tr>
<tr class="even">
<td align="left">Jo-Wilfried Tsonga</td>
<td align="right">2.0</td>
<td align="left">[ 0 - 15 ]</td>
</tr>
<tr class="odd">
<td align="left">Stan Wawrinka</td>
<td align="right">1.3</td>
<td align="left">[ 0 - 11 ]</td>
</tr>
<tr class="even">
<td align="left">Andrey Rublev</td>
<td align="right">0.8</td>
<td align="left">[ 0 - 11 ]</td>
</tr>
</tbody>
</table>
<p>Based on the model, Nadal has the highest probability of beating Djokovic at Wimbledon (23.7 % with 90% credible interval of [4%, 60%]), followed closely by Roger Federer (20.9 % with 90% credible interval of [4%, 56%]).</p>
<p>Let’s say (God forbid), that the remaining 2 grand slams are cancelled this year. Who would have the best chances of winning the remaining grand slams this season?</p>
<p>Starting with Roland Garros, unsurprisingly Rafael Nadal has the highest probability of winning service points at this tournament and is thus crowned another French Open title. How does the rest of the ATP stack up against Nadal at Roland Garros? I present the top ATP players with the highest win probabilities against Nadal at 2020 Roland Garros:</p>
<table>
<thead>
<tr class="header">
<th align="left">Player</th>
<th align="right">Win %</th>
<th align="left">90% Credible Interval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Novak Djokovic</td>
<td align="right">28.1</td>
<td align="left">[ 6 - 66 ]</td>
</tr>
<tr class="even">
<td align="left">Stefanos Tsitsipas</td>
<td align="right">15.5</td>
<td align="left">[ 3 - 46 ]</td>
</tr>
<tr class="odd">
<td align="left">Dominic Thiem</td>
<td align="right">9.8</td>
<td align="left">[ 1 - 37 ]</td>
</tr>
<tr class="even">
<td align="left">Milos Raonic</td>
<td align="right">6.7</td>
<td align="left">[ 0 - 34 ]</td>
</tr>
<tr class="odd">
<td align="left">Roger Federer</td>
<td align="right">6.4</td>
<td align="left">[ 1 - 31 ]</td>
</tr>
<tr class="even">
<td align="left">Matteo Berrettini</td>
<td align="right">4.4</td>
<td align="left">[ 0 - 23 ]</td>
</tr>
<tr class="odd">
<td align="left">Andrey Rublev</td>
<td align="right">2.9</td>
<td align="left">[ 0 - 20 ]</td>
</tr>
<tr class="even">
<td align="left">Juan Martin del Potro</td>
<td align="right">2.7</td>
<td align="left">[ 0 - 21 ]</td>
</tr>
<tr class="odd">
<td align="left">Alexander Zverev</td>
<td align="right">2.4</td>
<td align="left">[ 0 - 15 ]</td>
</tr>
<tr class="even">
<td align="left">Jan Lennard Struff</td>
<td align="right">1.8</td>
<td align="left">[ 0 - 13 ]</td>
</tr>
</tbody>
</table>
<p>Here, we see that Djokovic has the highest probability of beating Djokovic at Wimbledon (28.1 % with 90% credible interval of [6%, 66%]), followed by Stefanos Tsitsipas (15.5 % with 90% credible interval of [3%, 46%]). Roger Federer falls to 5th in terms of players most likely to beat Nadal at Rolland Garros (behind Thiem and Raonic).</p>
<p>Ending out our hypothetical scenarios with the (usual) last grand slam tournament of the season, US Open, we find that Novak Djokovic has the highest probability of winning service points at this tournament and is thus crowned the US Open chip. How does the rest of the ATP stack up against Djokovic at US Open?</p>
<table>
<thead>
<tr class="header">
<th align="left">Player</th>
<th align="right">Win %</th>
<th align="left">90% Credible Interval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Rafael Nadal</td>
<td align="right">28.3</td>
<td align="left">[ 8 - 61 ]</td>
</tr>
<tr class="even">
<td align="left">Roger Federer</td>
<td align="right">17.1</td>
<td align="left">[ 3 - 46 ]</td>
</tr>
<tr class="odd">
<td align="left">Stefanos Tsitsipas</td>
<td align="right">17.1</td>
<td align="left">[ 4 - 44 ]</td>
</tr>
<tr class="even">
<td align="left">Daniil Medvedev</td>
<td align="right">10.6</td>
<td align="left">[ 2 - 35 ]</td>
</tr>
<tr class="odd">
<td align="left">Milos Raonic</td>
<td align="right">9.4</td>
<td align="left">[ 2 - 30 ]</td>
</tr>
<tr class="even">
<td align="left">Dominic Thiem</td>
<td align="right">8.6</td>
<td align="left">[ 1 - 29 ]</td>
</tr>
<tr class="odd">
<td align="left">Juan Martin del Potro</td>
<td align="right">8.4</td>
<td align="left">[ 1 - 38 ]</td>
</tr>
<tr class="even">
<td align="left">Andrey Rublev</td>
<td align="right">8.0</td>
<td align="left">[ 1 - 29 ]</td>
</tr>
<tr class="odd">
<td align="left">Alexander Zverev</td>
<td align="right">5.7</td>
<td align="left">[ 1 - 23 ]</td>
</tr>
<tr class="even">
<td align="left">Roberto Bautista Agut</td>
<td align="right">5.6</td>
<td align="left">[ 1 - 23 ]</td>
</tr>
</tbody>
</table>
<p>Here, we see 4 ATP players with double digit probabilities of winning against Djokovic at US Open which suggests that this grand slam may be the most uncertain tournament to predict. Nadal and Federer appear to be the most likely culprits to defeat Djokovic with probabilities 28.3% and 17.1% respectively. It is very interesting to note that Milos Raonic was consistently ranked in the top 5 of players with the highest chances of winning a grand slam this season. At age 29, hopefully we will see some great things from the Canadian Ace as the season resumes!</p>
</div>
</div>
<div id="wta-players" class="section level1">
<h1>WTA Players</h1>
<p>Naturally, after seeing the ouput of the bayesian point-based model on ATP players, we might ask “How does this model do on WTA players?”.</p>
<p>Let’s find out</p>
<p><img src="wta_skill_17_20.png" /></p>
<p><img src="wta_surface_17_20.png" /></p>
<p><img src="wta_SKGM_20.png" /></p>
<p><img src="wta_SKGM_match_20.png" />
<img src="wta_SKGM_setscore_20.png" /></p>
<div id="being-up-front-about-the-assumptions" class="section level3">
<h3>Being up-front about the assumptions</h3>
<p>All predictive models we make are wrong. We hope to adequately capture all underlying processes, however to fit models we have to make some simplifying assumptions. The main assumption made in fitting this model was that service point outcomes are I.I.D. for an entire match (i.e. all service points in a match are played equally). Of course, we know that point outcomes in practice are not independent, nor are they identically distributed. Throughout a match, there exists momentum from game-to-game, which means that the outcome of a previous serve can influence the current serve. Furthermore, the performance of players on serve may differ depending on the pressure situation of the match. We may have reason to believe that a serve on the first service of the match compared to a serve when facing strenuous break opportunities may be drastically different. While the I.I.D. assumption in tennis does not hold, <span class="citation">Klaassen and Magnus (2001)</span> showed that these deviations are quite weak and thus the I.I.D. assumption may be a “good approximation” for match prediction. Furthermore, it was also assumed that player skills evolve according to a Gaussian random walk where player skills change smoothly from one period to the next with equal variance. This assumption, in general, is also not true since some players exhibit rapid increases or decreases in skill during the beginning and end of their careers. However, these deviations from our assumptions may also be weak since most players observed in the collected data are representative of established players in the prime years of their tennis career. Hence, we expect the majority of players to be playing with consistent skill levels.</p>
</div>
<div id="data-issues" class="section level3">
<h3>Data Issues</h3>
<p>Some of the entries in the data taken from Jeff Sackmann’s repository appear to be incomplete. Some matches indicate that 0 service points were won on 0 serve point opportunities, while other entries indicate numbers that don’t make sense under a tennis match context. In a best of 3 set match, we would expect that a player should have at the very least (4 points / game) * (6 games / set) * (2 sets / Match) = 48 serves.</p>
<p>Some matches may have ended prematurely (ex: from player injury), and we see some entries with service games less than 48.</p>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>Using a Bayesian Hierarchical Model, we can account for individual player effects by considering their court surface preferences, as well as the evolution of their serve and return skills as the season progresses. Using Stan, we obtain posterior estimates of serve, return and surface skill for each player and saw who was likely to hoist the grand slam tournaments in 2020.</p>
</div>
<div id="sources" class="section level2 unnumbered">
<h2>Sources</h2>
<div id="refs" class="references">
<div id="ref-IngramMartin2019ApBh">
<p>Ingram, Martin. 2019. “A Point-Based Bayesian Hierarchical Model to Predict the Outcome of Tennis Matches.” <em>Journal of Quantitative Analysis in Sports</em> 15 (4). De Gruyter: 313–25.</p>
</div>
<div id="ref-KlaassenFrancJGM2001APiT">
<p>Klaassen, Franc J G M, and Jan R Magnus. 2001. “Are Points in Tennis Independent and Identically Distributed? Evidence from a Dynamic Binary Panel Data Model.” <em>Journal of the American Statistical Association</em> 96 (454). Taylor &amp; Francis: 500–509. <a href="http://www.tandfonline.com/doi/abs/10.1198/016214501753168217">http://www.tandfonline.com/doi/abs/10.1198/016214501753168217</a>.</p>
</div>
<div id="ref-NewtonPaulK.2005PoWa">
<p>Newton, Paul K., and Joseph B. Keller. 2005. “Probability of Winning at Tennis I. Theory and Data.” <em>Studies in Applied Mathematics</em> 114 (3): 241–69.</p>
</div>
</div>
</div>
</div>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/tennis/">Tennis</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/project/bayesian-hierarchical-models/&amp;text=Bayesian%20Hierarchical%20Models%20in%20Tennis" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/project/bayesian-hierarchical-models/&amp;t=Bayesian%20Hierarchical%20Models%20in%20Tennis" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Bayesian%20Hierarchical%20Models%20in%20Tennis&amp;body=/project/bayesian-hierarchical-models/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/project/bayesian-hierarchical-models/&amp;title=Bayesian%20Hierarchical%20Models%20in%20Tennis" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Bayesian%20Hierarchical%20Models%20in%20Tennis%20/project/bayesian-hierarchical-models/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/project/bayesian-hierarchical-models/&amp;title=Bayesian%20Hierarchical%20Models%20in%20Tennis" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  
  
    
  
  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu96a5ab8e0364e843af4687201b687892_52303_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Peter Tea</a></h5>
      <h6 class="card-subtitle">Msc. Statistics</h6>
      <p class="card-text">Putting sports through the <code>Tea-test</code></p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/petertea/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/petertea96" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/2019-serve-speeds/">Analysing the Tennis Serve Power vs. Consistency Tradeoff</a></li>
      
      <li><a href="/post/2019-grand-slam/">Analysing Serving Abilities at Grand Slams</a></li>
      
      <li><a href="/talk/sports-analytics/">Data Visualization in Tennis</a></li>
      
    </ul>
  </div>
  



    <div class="project-related-pages content-widget-hr">
      
      

      
      
      

      
      
      

      
      
      
    </div>
  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.bcfae8267aba63cc55af53a503896bd9.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    &copy; 2020 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
